import xlrd
import matplotlib.pyplot as plt


Adresse = 'M:\Feuille.xlsx'
document = xlrd.open_workbook(Adresse)
feuille_1 = document.sheet_by_index(0)
 

cols = feuille_1.ncols
rows = feuille_1.nrows


def RécupVilles():
    ListeVilles = []
    for r in range(1, rows):
        ListeVilles += [feuille_1.cell_value(rowx=r, colx=0)]
    return ListeVilles
    
def CréerMatriceDS():
    Matrice = [[ None for i in range(rows -1) ] for i in range (cols - 1)]
    for i in range(1,cols ):
        for j in range(1,rows):
            Matrice[i-1][j-1] = feuille_1.cell_value(rowx=i,colx=j)
    return Matrice

def CréerMatriceDD():
    MegaMatrice = []
    for k in range (1, int(str(document.nsheets)) + 1):
        feuille = document.sheet_by_index(k-1)
        Matrice = [[ None for i in range(rows -1) ] for i in range (cols - 1)]
        for i in range(1,cols ):
            for j in range(1,rows):
                Matrice[i-1][j-1] = feuille.cell_value(rowx=i,colx=j)
        MegaMatrice.append(Matrice)
    return MegaMatrice
